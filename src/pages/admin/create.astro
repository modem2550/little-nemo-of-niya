---
import "../../styles/main.css";
---

<meta charset="UTF-8" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<div class="container">
  <h1>เพิ่ม Event ใหม่</h1>
  <form id="createForm">
    <p>ชื่อกิจกรรม</p><input name="title" required />
    <p>วันที่</p><input type="date" name="date" required />
    <p>ถึงวันที่</p><input type="date" name="end_date" />
    <p>สถานที่</p><input name="location" />
    <p>ลิงก์</p><input name="link" />
    <p>รูปภาพ</p><input name="image_url" />
    <p>Live</p><input name="live" />

    <button type="submit" class="btn btn-primary">บันทึก</button>
  </form>
</div>

<script>
  const form = document.getElementById("createForm") as HTMLFormElement;
if (!form) throw new Error("Form not found");

form.addEventListener("submit", async (e) => {
  e.preventDefault();

  const data = new FormData(form);

  try {
    const res = await fetch("/api/admin-event-create", {
      method: "POST",
      body: data
    });

    if (res.ok) {
      window.location.href = "/admin";
    } else {
      const text = await res.text();
      alert("เกิดข้อผิดพลาด: " + text);
    }
  } catch (err) {
    console.error(err);
    alert("เกิดข้อผิดพลาดเครือข่าย");
  }
});

</script>
